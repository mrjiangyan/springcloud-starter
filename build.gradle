allprojects {
    apply plugin: 'maven'
    apply plugin: 'maven-publish'
    apply plugin: 'java'

    group = 'com.touchbiz.starter'
    version = '1.0'
    buildscript {
        ext {
            commonLang3Version = '3.10'
            aspectjVersion = 'deploy.sh.5'
            springBootVersion = '2.3.5.RELEASE'
            springVersion = '5.2.8.RELEASE'
            springCloudVersion = '2.1.2.RELEASE'
            mavenUserName = '5f573af3e1cf498f370573c8'
            mavenPassword = 'WDwiza3S(oFV'
            //toplist配置
//            mavenUserName = '5f03d6a0cc3021d7e3b10d1e'
//            mavenPassword = 'OFLvR=ICCSgt'


            lombokVersion = '1.18.12'
            nacosStarterVersion = '2.1.0.RELEASE'
            swaggerVersion = '3.0.0'
            swaggerLayerVersion = '1.1.3'
            commonEntityVersion = '1.8.RELEASE'
            commonVersion = '1.7.RELEASE'
            commonPoolVersion = '1.6'
            mybatisVersion = '2.1.3'
            druidVersion = '1.2.3'
            tkVersion = '4.1.5'
            oneVersion = '1.8.6.Final'
            feignVersion = "10.10.1"
            openFeignVersion = '2.2.3.RELEASE'
            validationVersion = '2.0.1.Final'
            mysqlVerision = '8.0.20'
            revision = '2.3.RELEASE'
            jacksonVersion = '2.11.1'
            repositoryUrl = 'https://packages.aliyun.com/maven/repository/2031284-release-KDf3XN'
            //toplist 配置
//            repositoryUrl = 'https://packages.aliyun.com/maven/repository/2041383-release-F0cHwt/'

        }
        repositories {
            mavenCentral()
        }


    }


}


/**所有子项目应用Java插件*/

subprojects {
    apply plugin: 'maven'
    apply plugin: 'maven-publish'
    apply plugin: 'java'

    sourceCompatibility = '1.8'
    group = 'com.touchbiz.starter'
    version = "${ revision }"

    repositories {
        google()
        jcenter()
        maven { url 'https://maven.aliyun.com/nexus/content/groups/public/' }
        maven { url 'https://repo.spring.io/snapshot' }
        maven { url 'https://repo.spring.io/milestone' }
        mavenCentral()
        maven {
            credentials {
                username "$mavenUserName"
                password "$mavenPassword"
            }
            url 'https://packages.aliyun.com/maven/repository/2031284-release-KDf3XN/'
//            url 'https://packages.aliyun.com/maven/repository/2041383-release-F0cHwt/'
        }
    }


    configurations {
        compileOnly {
            extendsFrom annotationProcessor
        }
    }

    //打包源代码
    task sourcesJar(type: Jar, dependsOn: classes) {
        classifier = 'sources'
        from sourceSets.main.allSource
    }

    configurations.all {
        exclude group: "org.springframework.boot", module: "spring-boot-starter-tomcat"
        exclude group: "io.undertow", module: "undertow-websockets-jsr"
        exclude group: "io.springfox", module:"springfox-swagger-ui"
    }

    [compileJava, compileTestJava]*.options*.encoding = 'UTF-8'

    artifacts {
        archives sourcesJar
    }


//    publishing {
//        publications {
//            mavenJava(MavenPublication) {
//                //指定group/artifact/version信息
//                groupId "$project.group"
//                version "$project.version"
//                artifactId "$artifactId"
//                description '公共类库'
//                from components.java
//
//                // 增加 sourcesJar 任务
//                artifact sourcesJar
//            }
//        }
//        // 发布仓库
//        repositories {
//            mavenLocal()
//
//            maven {
//                // 凭证
//                credentials {
//                    username "$mavenUserName" // 仓库发布用户名
//                    password "$mavenPassword" // 仓库发布用户密码
//                }
//                // 地址
//                url 'https://packages.aliyun.com/maven/repository/2031284-release-KDf3XN/'
//            }
//        }
//    }

    dependencies {
        compileOnly group: 'org.projectlombok', name: 'lombok', version: "${ lombokVersion }"
        annotationProcessor group: 'org.projectlombok', name: 'lombok', version: "${ lombokVersion }"
    }

}
